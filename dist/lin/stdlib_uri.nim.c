/* Generated by Nim Compiler v1.3.7 */
/*   (c) 2020 Andreas Rumpf */
/* The generated code is subject to the original license. */
#define NIM_INTBITS 64

/* section: NIM_merge_HEADERS */

#include "nimbase.h"
#include <string.h>
#undef LANGUAGE_C
#undef MIPSEB
#undef MIPSEL
#undef PPC
#undef R3000
#undef R4000
#undef i386
#undef linux
#undef mips
#undef near
#undef far
#undef powerpc
#undef unix

/* section: NIM_merge_FRAME_DEFINES */
#define nimfr_(x, y)
#define nimln_(x, y)

/* section: NIM_merge_FORWARD_TYPES */
typedef struct tyObject_Uri__j49bukNPrq747O1GRd4Ng9bQ tyObject_Uri__j49bukNPrq747O1GRd4Ng9bQ;
typedef struct NimStrPayload NimStrPayload;
typedef struct NimStringV2 NimStringV2;
typedef struct tyObject_HSlice__EE5dzjqoOrHT6HJhIPXAvA tyObject_HSlice__EE5dzjqoOrHT6HJhIPXAvA;

/* section: NIM_merge_TYPES */
struct NimStrPayload {
NI cap;
NIM_CHAR data[SEQ_DECL_SIZE];
};
struct NimStringV2 {
NI len;
NimStrPayload* p;
};
struct tyObject_Uri__j49bukNPrq747O1GRd4Ng9bQ {
NimStringV2 scheme;
NimStringV2 username;
NimStringV2 password;
NimStringV2 hostname;
NimStringV2 port;
NimStringV2 path;
NimStringV2 query;
NimStringV2 anchor;
NIM_BOOL opaque;
NIM_BOOL isIpv6;
};
typedef NU8 tySet_tyChar__nmiMWKVIe46vacnhAFrQvw[32];
struct tyObject_HSlice__EE5dzjqoOrHT6HJhIPXAvA {
NI a;
NI b;
};

/* section: NIM_merge_PROC_HEADERS */
static N_INLINE(void, nimZeroMem)(void* p, NI size);
static N_INLINE(void, nimSetMem__zxfKBYntu9cBapkhrCOk1fgmemory)(void* a, int v, NI size);
N_LIB_PRIVATE N_NIMCALL(tyObject_Uri__j49bukNPrq747O1GRd4Ng9bQ, initUri__zcwd3ynrfDQcP9c8k9cEeg9aQ)(void);
N_LIB_PRIVATE N_NIMCALL(void, parseUri__2Afz5k9c4YIkP0o0kpbe9cvQ)(NimStringV2 uri, tyObject_Uri__j49bukNPrq747O1GRd4Ng9bQ* result);
N_LIB_PRIVATE N_NIMCALL(void, resetUri__6wZ9cdrNwSrw8xkgtsNgsVQ)(tyObject_Uri__j49bukNPrq747O1GRd4Ng9bQ* uri);
N_LIB_PRIVATE N_NIMCALL(void, setLengthStrV2)(NimStringV2* s, NI newLen);
N_LIB_PRIVATE N_NIMCALL(void, parsePath__0TsSB8FdgpD9cp7XiVe8wdA)(NimStringV2 uri, NI* i, tyObject_Uri__j49bukNPrq747O1GRd4Ng9bQ* result);
static N_INLINE(NI, parseUntil__yxs3WjxMSDtXEyiLC9aqFCAparseutils)(NimStringV2 s, NimStringV2* token, tySet_tyChar__nmiMWKVIe46vacnhAFrQvw until, NI start);
N_LIB_PRIVATE N_NIMCALL(void, fastSubstr__a88zu6ztJ3SBDTHcnqFjsg)(NimStringV2 s, NimStringV2* token, NI start, NI length);
N_LIB_PRIVATE N_NIMCALL(NI, nsuCmpIgnoreCase)(NimStringV2 a, NimStringV2 b);
N_LIB_PRIVATE N_NIMCALL(void, parseAuthority__zi1fIQvZNRFlvZX648raeA)(NimStringV2 authority, tyObject_Uri__j49bukNPrq747O1GRd4Ng9bQ* result);
static N_INLINE(void, nimAddCharV1)(NimStringV2* s, NIM_CHAR c);
N_LIB_PRIVATE N_NIMCALL(void, prepareAdd)(NimStringV2* s, NI addlen);
static N_INLINE(NI, parseWhile__aIOGZyeHx2rHC71Dcc2SCwparseutils)(NimStringV2 s, NimStringV2* token, tySet_tyChar__nmiMWKVIe46vacnhAFrQvw validChars, NI start);
N_LIB_PRIVATE N_NIMCALL(void, eqdestroy___dS1BF3Vxjg9aJMmmhVJKSpQ)(NimStringV2* dest);
N_LIB_PRIVATE N_NIMCALL(void, eq___aBBXmHFBEivKqERloP6zmA_2)(NimStringV2* dest, NimStringV2 src);
static N_INLINE(void, appendString)(NimStringV2* dest, NimStringV2 src);
static N_INLINE(void, copyMem__i80o3k0SgEI5gTRCzYdyWAsystem)(void* dest, void* source, NI size);
static N_INLINE(void, nimCopyMem)(void* dest, void* source, NI size);
static N_INLINE(NIM_BOOL, endsWith__IC89a6ZhQ52RmT4pzQl6YbAstrutils)(NimStringV2 s, NIM_CHAR suffix);
static N_INLINE(NimStringV2, X5BX5D___ogYTOKbgqbjPfyC123US1gsystem)(NimStringV2 s, tyObject_HSlice__EE5dzjqoOrHT6HJhIPXAvA x);
N_NIMCALL(NimStringV2, mnewString)(NI len);
static N_INLINE(void, nimPrepareStrMutationV2)(NimStringV2* s);
N_LIB_PRIVATE N_NIMCALL(void, nimPrepareStrMutationImpl__C0YoABEefTaYbWLv9aVOzZA)(NimStringV2* s);
static N_INLINE(tyObject_HSlice__EE5dzjqoOrHT6HJhIPXAvA, dotdot___xNR8BVBMWzS9bXXNMikmyLgsystem)(NI a, NI b);
N_LIB_PRIVATE N_NIMCALL(NimStringV2, rawNewString)(NI space);

/* section: NIM_merge_DATA */
static const struct {
  NI cap; NIM_CHAR data[0+1];
} TM__VzbRQH9cb1xm1tSKH4PwBSw_2 = { 0 | NIM_STRLIT_FLAG, "" };
static const NimStringV2 TM__VzbRQH9cb1xm1tSKH4PwBSw_3 = {0, (NimStrPayload*)&TM__VzbRQH9cb1xm1tSKH4PwBSw_2};
static const NimStringV2 TM__VzbRQH9cb1xm1tSKH4PwBSw_4 = {0, (NimStrPayload*)&TM__VzbRQH9cb1xm1tSKH4PwBSw_2};
static const NimStringV2 TM__VzbRQH9cb1xm1tSKH4PwBSw_5 = {0, (NimStrPayload*)&TM__VzbRQH9cb1xm1tSKH4PwBSw_2};
static const NimStringV2 TM__VzbRQH9cb1xm1tSKH4PwBSw_6 = {0, (NimStrPayload*)&TM__VzbRQH9cb1xm1tSKH4PwBSw_2};
static const NimStringV2 TM__VzbRQH9cb1xm1tSKH4PwBSw_7 = {0, (NimStrPayload*)&TM__VzbRQH9cb1xm1tSKH4PwBSw_2};
static const NimStringV2 TM__VzbRQH9cb1xm1tSKH4PwBSw_8 = {0, (NimStrPayload*)&TM__VzbRQH9cb1xm1tSKH4PwBSw_2};
static const NimStringV2 TM__VzbRQH9cb1xm1tSKH4PwBSw_9 = {0, (NimStrPayload*)&TM__VzbRQH9cb1xm1tSKH4PwBSw_2};
static const NimStringV2 TM__VzbRQH9cb1xm1tSKH4PwBSw_10 = {0, (NimStrPayload*)&TM__VzbRQH9cb1xm1tSKH4PwBSw_2};
static NIM_CONST tySet_tyChar__nmiMWKVIe46vacnhAFrQvw TM__VzbRQH9cb1xm1tSKH4PwBSw_11 = {
0x00, 0x00, 0x00, 0x00, 0x08, 0x00, 0x00, 0x80,
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00}
;
static const struct {
  NI cap; NIM_CHAR data[6+1];
} TM__VzbRQH9cb1xm1tSKH4PwBSw_12 = { 6 | NIM_STRLIT_FLAG, "mailto" };
static const NimStringV2 TM__VzbRQH9cb1xm1tSKH4PwBSw_13 = {6, (NimStrPayload*)&TM__VzbRQH9cb1xm1tSKH4PwBSw_12};
static NIM_CONST tySet_tyChar__nmiMWKVIe46vacnhAFrQvw TM__VzbRQH9cb1xm1tSKH4PwBSw_14 = {
0x00, 0x00, 0x00, 0x00, 0x08, 0x00, 0x00, 0x00,
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00}
;
static NIM_CONST tySet_tyChar__nmiMWKVIe46vacnhAFrQvw TM__VzbRQH9cb1xm1tSKH4PwBSw_15 = {
0x00, 0x00, 0x00, 0x00, 0x00, 0x68, 0xff, 0x03,
0xfe, 0xff, 0xff, 0x07, 0xfe, 0xff, 0xff, 0x07,
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00}
;
static const NimStringV2 TM__VzbRQH9cb1xm1tSKH4PwBSw_16 = {0, (NimStrPayload*)&TM__VzbRQH9cb1xm1tSKH4PwBSw_2};
static NIM_CONST tySet_tyChar__nmiMWKVIe46vacnhAFrQvw TM__VzbRQH9cb1xm1tSKH4PwBSw_17 = {
0x00, 0x00, 0x00, 0x00, 0x08, 0x80, 0x00, 0x80,
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00}
;
static const NimStringV2 TM__VzbRQH9cb1xm1tSKH4PwBSw_18 = {0, (NimStrPayload*)&TM__VzbRQH9cb1xm1tSKH4PwBSw_2};
static const struct {
  NI cap; NIM_CHAR data[1+1];
} TM__VzbRQH9cb1xm1tSKH4PwBSw_19 = { 1 | NIM_STRLIT_FLAG, ":" };
static const NimStringV2 TM__VzbRQH9cb1xm1tSKH4PwBSw_20 = {1, (NimStrPayload*)&TM__VzbRQH9cb1xm1tSKH4PwBSw_19};
static const struct {
  NI cap; NIM_CHAR data[3+1];
} TM__VzbRQH9cb1xm1tSKH4PwBSw_21 = { 3 | NIM_STRLIT_FLAG, "://" };
static const NimStringV2 TM__VzbRQH9cb1xm1tSKH4PwBSw_22 = {3, (NimStrPayload*)&TM__VzbRQH9cb1xm1tSKH4PwBSw_21};
static const NimStringV2 TM__VzbRQH9cb1xm1tSKH4PwBSw_23 = {1, (NimStrPayload*)&TM__VzbRQH9cb1xm1tSKH4PwBSw_19};
static const struct {
  NI cap; NIM_CHAR data[1+1];
} TM__VzbRQH9cb1xm1tSKH4PwBSw_24 = { 1 | NIM_STRLIT_FLAG, "@" };
static const NimStringV2 TM__VzbRQH9cb1xm1tSKH4PwBSw_25 = {1, (NimStrPayload*)&TM__VzbRQH9cb1xm1tSKH4PwBSw_24};
static const struct {
  NI cap; NIM_CHAR data[1+1];
} TM__VzbRQH9cb1xm1tSKH4PwBSw_26 = { 1 | NIM_STRLIT_FLAG, "[" };
static const NimStringV2 TM__VzbRQH9cb1xm1tSKH4PwBSw_27 = {1, (NimStrPayload*)&TM__VzbRQH9cb1xm1tSKH4PwBSw_26};
static const struct {
  NI cap; NIM_CHAR data[1+1];
} TM__VzbRQH9cb1xm1tSKH4PwBSw_28 = { 1 | NIM_STRLIT_FLAG, "]" };
static const NimStringV2 TM__VzbRQH9cb1xm1tSKH4PwBSw_29 = {1, (NimStrPayload*)&TM__VzbRQH9cb1xm1tSKH4PwBSw_28};
static const NimStringV2 TM__VzbRQH9cb1xm1tSKH4PwBSw_30 = {1, (NimStrPayload*)&TM__VzbRQH9cb1xm1tSKH4PwBSw_26};
static const NimStringV2 TM__VzbRQH9cb1xm1tSKH4PwBSw_31 = {1, (NimStrPayload*)&TM__VzbRQH9cb1xm1tSKH4PwBSw_28};
static const NimStringV2 TM__VzbRQH9cb1xm1tSKH4PwBSw_32 = {1, (NimStrPayload*)&TM__VzbRQH9cb1xm1tSKH4PwBSw_19};
static const struct {
  NI cap; NIM_CHAR data[1+1];
} TM__VzbRQH9cb1xm1tSKH4PwBSw_33 = { 1 | NIM_STRLIT_FLAG, "\?" };
static const NimStringV2 TM__VzbRQH9cb1xm1tSKH4PwBSw_34 = {1, (NimStrPayload*)&TM__VzbRQH9cb1xm1tSKH4PwBSw_33};
static const struct {
  NI cap; NIM_CHAR data[1+1];
} TM__VzbRQH9cb1xm1tSKH4PwBSw_35 = { 1 | NIM_STRLIT_FLAG, "#" };
static const NimStringV2 TM__VzbRQH9cb1xm1tSKH4PwBSw_36 = {1, (NimStrPayload*)&TM__VzbRQH9cb1xm1tSKH4PwBSw_35};

/* section: NIM_merge_PROCS */
static N_INLINE(void, nimSetMem__zxfKBYntu9cBapkhrCOk1fgmemory)(void* a, int v, NI size) {
	void* T1_;
	T1_ = (void*)0;
	T1_ = memset(a, v, ((size_t) (size)));
}
static N_INLINE(void, nimZeroMem)(void* p, NI size) {
	nimSetMem__zxfKBYntu9cBapkhrCOk1fgmemory(p, ((int) 0), size);
}
N_LIB_PRIVATE N_NIMCALL(tyObject_Uri__j49bukNPrq747O1GRd4Ng9bQ, initUri__zcwd3ynrfDQcP9c8k9cEeg9aQ)(void) {
	tyObject_Uri__j49bukNPrq747O1GRd4Ng9bQ result;
	nimZeroMem((void*)(&result), sizeof(tyObject_Uri__j49bukNPrq747O1GRd4Ng9bQ));
	nimZeroMem((void*)(&result), sizeof(tyObject_Uri__j49bukNPrq747O1GRd4Ng9bQ));
	result.scheme = TM__VzbRQH9cb1xm1tSKH4PwBSw_3;
	result.username = TM__VzbRQH9cb1xm1tSKH4PwBSw_4;
	result.password = TM__VzbRQH9cb1xm1tSKH4PwBSw_5;
	result.hostname = TM__VzbRQH9cb1xm1tSKH4PwBSw_6;
	result.port = TM__VzbRQH9cb1xm1tSKH4PwBSw_7;
	result.path = TM__VzbRQH9cb1xm1tSKH4PwBSw_8;
	result.query = TM__VzbRQH9cb1xm1tSKH4PwBSw_9;
	result.anchor = TM__VzbRQH9cb1xm1tSKH4PwBSw_10;
	return result;
}
N_LIB_PRIVATE N_NIMCALL(void, resetUri__6wZ9cdrNwSrw8xkgtsNgsVQ)(tyObject_Uri__j49bukNPrq747O1GRd4Ng9bQ* uri) {
	setLengthStrV2((&(*uri).scheme), ((NI) 0));
	setLengthStrV2((&(*uri).username), ((NI) 0));
	setLengthStrV2((&(*uri).password), ((NI) 0));
	setLengthStrV2((&(*uri).hostname), ((NI) 0));
	setLengthStrV2((&(*uri).port), ((NI) 0));
	setLengthStrV2((&(*uri).path), ((NI) 0));
	setLengthStrV2((&(*uri).query), ((NI) 0));
	setLengthStrV2((&(*uri).anchor), ((NI) 0));
	(*uri).opaque = NIM_FALSE;
	(*uri).isIpv6 = NIM_FALSE;
}
static N_INLINE(NI, parseUntil__yxs3WjxMSDtXEyiLC9aqFCAparseutils)(NimStringV2 s, NimStringV2* token, tySet_tyChar__nmiMWKVIe46vacnhAFrQvw until, NI start) {
	NI result;
	NI i;
	result = (NI)0;
	i = start;
	{
		while (1) {
			NIM_BOOL T3_;
			T3_ = (NIM_BOOL)0;
			T3_ = (i < s.len);
			if (!(T3_)) goto LA4_;
			T3_ = !(((until[(NU)(((NU8)(s.p->data[i])))>>3] &(1U<<((NU)(((NU8)(s.p->data[i])))&7U)))!=0));
			LA4_: ;
			if (!T3_) goto LA2;
			i += ((NI) 1);
		} LA2: ;
	}
	result = (NI)(i - start);
	fastSubstr__a88zu6ztJ3SBDTHcnqFjsg(s, token, start, result);
	return result;
}
static N_INLINE(void, nimAddCharV1)(NimStringV2* s, NIM_CHAR c) {
	prepareAdd(s, ((NI) 1));
	(*(*s).p).data[(*s).len] = c;
	(*(*s).p).data[(NI)((*s).len + ((NI) 1))] = 0;
	(*s).len += ((NI) 1);
}
N_LIB_PRIVATE N_NIMCALL(void, parseAuthority__zi1fIQvZNRFlvZX648raeA)(NimStringV2 authority, tyObject_Uri__j49bukNPrq747O1GRd4Ng9bQ* result) {
	NI i;
	NIM_BOOL inPort;
	NIM_BOOL inIPv6;
	i = ((NI) 0);
	inPort = NIM_FALSE;
	inIPv6 = NIM_FALSE;
	{
		while (1) {
			if (!(i < authority.len)) goto LA2;
			switch (((NU8)(authority.p->data[i]))) {
			case 64:
			{
				NimStringV2 T4_;
				NimStringV2 T5_;
				T4_.len = 0; T4_.p = NIM_NIL;
				T4_ = (*result).password;
				(*result).password = (*result).port;
				(*result).port = T4_;
				setLengthStrV2((&(*result).port), ((NI) 0));
				T5_.len = 0; T5_.p = NIM_NIL;
				T5_ = (*result).username;
				(*result).username = (*result).hostname;
				(*result).hostname = T5_;
				setLengthStrV2((&(*result).hostname), ((NI) 0));
				inPort = NIM_FALSE;
			}
			break;
			case 58:
			{
				{
					if (!inIPv6) goto LA9_;
					nimAddCharV1((&(*result).hostname), authority.p->data[i]);
				}
				goto LA7_;
				LA9_: ;
				{
					inPort = NIM_TRUE;
				}
				LA7_: ;
			}
			break;
			case 91:
			{
				inIPv6 = NIM_TRUE;
				(*result).isIpv6 = NIM_TRUE;
			}
			break;
			case 93:
			{
				inIPv6 = NIM_FALSE;
			}
			break;
			default:
			{
				{
					if (!inPort) goto LA17_;
					nimAddCharV1((&(*result).port), authority.p->data[i]);
				}
				goto LA15_;
				LA17_: ;
				{
					nimAddCharV1((&(*result).hostname), authority.p->data[i]);
				}
				LA15_: ;
			}
			break;
			}
			i += ((NI) 1);
		} LA2: ;
	}
}
N_LIB_PRIVATE N_NIMCALL(void, parsePath__0TsSB8FdgpD9cp7XiVe8wdA)(NimStringV2 uri, NI* i, tyObject_Uri__j49bukNPrq747O1GRd4Ng9bQ* result) {
	NI T1_;
	T1_ = (NI)0;
	T1_ = parseUntil__yxs3WjxMSDtXEyiLC9aqFCAparseutils(uri, (&(*result).path), TM__VzbRQH9cb1xm1tSKH4PwBSw_11, (*i));
	(*i) += T1_;
	{
		NI T4_;
		T4_ = (NI)0;
		T4_ = nsuCmpIgnoreCase((*result).scheme, TM__VzbRQH9cb1xm1tSKH4PwBSw_13);
		if (!(T4_ == ((NI) 0))) goto LA5_;
		parseAuthority__zi1fIQvZNRFlvZX648raeA((*result).path, result);
		setLengthStrV2((&(*result).path), ((NI) 0));
	}
	LA5_: ;
	{
		NIM_BOOL T9_;
		NI T13_;
		T9_ = (NIM_BOOL)0;
		T9_ = ((*i) < uri.len);
		if (!(T9_)) goto LA10_;
		T9_ = ((NU8)(uri.p->data[(*i)]) == (NU8)(63));
		LA10_: ;
		if (!T9_) goto LA11_;
		(*i) += ((NI) 1);
		T13_ = (NI)0;
		T13_ = parseUntil__yxs3WjxMSDtXEyiLC9aqFCAparseutils(uri, (&(*result).query), TM__VzbRQH9cb1xm1tSKH4PwBSw_14, (*i));
		(*i) += T13_;
	}
	LA11_: ;
	{
		NIM_BOOL T16_;
		tySet_tyChar__nmiMWKVIe46vacnhAFrQvw T20_;
		NI T21_;
		T16_ = (NIM_BOOL)0;
		T16_ = ((*i) < uri.len);
		if (!(T16_)) goto LA17_;
		T16_ = ((NU8)(uri.p->data[(*i)]) == (NU8)(35));
		LA17_: ;
		if (!T16_) goto LA18_;
		(*i) += ((NI) 1);
		nimZeroMem(T20_, sizeof(tySet_tyChar__nmiMWKVIe46vacnhAFrQvw));
		T21_ = (NI)0;
		T21_ = parseUntil__yxs3WjxMSDtXEyiLC9aqFCAparseutils(uri, (&(*result).anchor), T20_, (*i));
		(*i) += T21_;
	}
	LA18_: ;
}
static N_INLINE(NI, parseWhile__aIOGZyeHx2rHC71Dcc2SCwparseutils)(NimStringV2 s, NimStringV2* token, tySet_tyChar__nmiMWKVIe46vacnhAFrQvw validChars, NI start) {
	NI result;
	NI i;
	result = (NI)0;
	i = start;
	{
		while (1) {
			NIM_BOOL T3_;
			T3_ = (NIM_BOOL)0;
			T3_ = (i < s.len);
			if (!(T3_)) goto LA4_;
			T3_ = ((validChars[(NU)(((NU8)(s.p->data[i])))>>3] &(1U<<((NU)(((NU8)(s.p->data[i])))&7U)))!=0);
			LA4_: ;
			if (!T3_) goto LA2;
			i += ((NI) 1);
		} LA2: ;
	}
	result = (NI)(i - start);
	fastSubstr__a88zu6ztJ3SBDTHcnqFjsg(s, token, start, result);
	return result;
}
N_LIB_PRIVATE N_NIMCALL(void, parseUri__2Afz5k9c4YIkP0o0kpbe9cvQ)(NimStringV2 uri, tyObject_Uri__j49bukNPrq747O1GRd4Ng9bQ* result) {
	NI i;
	NIM_BOOL doubleSlash;
	NIM_BOOL T1_;
	NI T13_;
{	resetUri__6wZ9cdrNwSrw8xkgtsNgsVQ(result);
	i = ((NI) 0);
	T1_ = (NIM_BOOL)0;
	T1_ = (((NI) 1) < uri.len);
	if (!(T1_)) goto LA2_;
	T1_ = ((NU8)(uri.p->data[((NI) 1)]) == (NU8)(47));
	LA2_: ;
	doubleSlash = T1_;
	{
		NIM_BOOL T5_;
		T5_ = (NIM_BOOL)0;
		T5_ = (i < uri.len);
		if (!(T5_)) goto LA6_;
		T5_ = ((NU8)(uri.p->data[i]) == (NU8)(47));
		LA6_: ;
		if (!T5_) goto LA7_;
		{
			if (!!(doubleSlash)) goto LA11_;
			parsePath__0TsSB8FdgpD9cp7XiVe8wdA(uri, (&i), result);
			goto BeforeRet_;
		}
		LA11_: ;
	}
	LA7_: ;
	T13_ = (NI)0;
	T13_ = parseWhile__aIOGZyeHx2rHC71Dcc2SCwparseutils(uri, (&(*result).scheme), TM__VzbRQH9cb1xm1tSKH4PwBSw_15, i);
	i += T13_;
	{
		NIM_BOOL T16_;
		NIM_BOOL T17_;
		T16_ = (NIM_BOOL)0;
		T17_ = (NIM_BOOL)0;
		T17_ = (uri.len <= i);
		if (T17_) goto LA18_;
		T17_ = !(((NU8)(uri.p->data[i]) == (NU8)(58)));
		LA18_: ;
		T16_ = T17_;
		if (!(T16_)) goto LA19_;
		T16_ = !(doubleSlash);
		LA19_: ;
		if (!T16_) goto LA20_;
		i = ((NI) 0);
		setLengthStrV2((&(*result).scheme), ((NI) 0));
		parsePath__0TsSB8FdgpD9cp7XiVe8wdA(uri, (&i), result);
		goto BeforeRet_;
	}
	LA20_: ;
	{
		if (!!(doubleSlash)) goto LA24_;
		i += ((NI) 1);
	}
	LA24_: ;
	{
		NIM_BOOL T28_;
		NIM_BOOL T29_;
		NimStringV2 authority;
		NI T34_;
		T28_ = (NIM_BOOL)0;
		T29_ = (NIM_BOOL)0;
		T29_ = ((NI)(i + ((NI) 1)) < uri.len);
		if (!(T29_)) goto LA30_;
		T29_ = ((NU8)(uri.p->data[i]) == (NU8)(47));
		LA30_: ;
		T28_ = T29_;
		if (!(T28_)) goto LA31_;
		T28_ = ((NU8)(uri.p->data[(NI)(i + ((NI) 1))]) == (NU8)(47));
		LA31_: ;
		if (!T28_) goto LA32_;
		authority.len = 0; authority.p = NIM_NIL;
		i += ((NI) 2);
		authority = TM__VzbRQH9cb1xm1tSKH4PwBSw_16;
		T34_ = (NI)0;
		T34_ = parseUntil__yxs3WjxMSDtXEyiLC9aqFCAparseutils(uri, (&authority), TM__VzbRQH9cb1xm1tSKH4PwBSw_17, i);
		i += T34_;
		{
			if (!(((NI) 0) < authority.len)) goto LA37_;
			parseAuthority__zi1fIQvZNRFlvZX648raeA(authority, result);
		}
		LA37_: ;
		eqdestroy___dS1BF3Vxjg9aJMmmhVJKSpQ((&authority));
	}
	goto LA26_;
	LA32_: ;
	{
		(*result).opaque = NIM_TRUE;
	}
	LA26_: ;
	parsePath__0TsSB8FdgpD9cp7XiVe8wdA(uri, (&i), result);
	}BeforeRet_: ;
}
N_LIB_PRIVATE N_NIMCALL(tyObject_Uri__j49bukNPrq747O1GRd4Ng9bQ, parseUri__rbZTAh57otUDsvMlWgTQog)(NimStringV2 uri) {
	tyObject_Uri__j49bukNPrq747O1GRd4Ng9bQ result;
	nimZeroMem((void*)(&result), sizeof(tyObject_Uri__j49bukNPrq747O1GRd4Ng9bQ));
	result = initUri__zcwd3ynrfDQcP9c8k9cEeg9aQ();
	parseUri__2Afz5k9c4YIkP0o0kpbe9cvQ(uri, (&result));
	return result;
}
N_LIB_PRIVATE N_NIMCALL(void, eq___OydxUV9ad0I3qVcqasXV7RQ)(tyObject_Uri__j49bukNPrq747O1GRd4Ng9bQ* dest, tyObject_Uri__j49bukNPrq747O1GRd4Ng9bQ* src) {
	eq___aBBXmHFBEivKqERloP6zmA_2((&(*dest).scheme), (*src).scheme);
	eq___aBBXmHFBEivKqERloP6zmA_2((&(*dest).username), (*src).username);
	eq___aBBXmHFBEivKqERloP6zmA_2((&(*dest).password), (*src).password);
	eq___aBBXmHFBEivKqERloP6zmA_2((&(*dest).hostname), (*src).hostname);
	eq___aBBXmHFBEivKqERloP6zmA_2((&(*dest).port), (*src).port);
	eq___aBBXmHFBEivKqERloP6zmA_2((&(*dest).path), (*src).path);
	eq___aBBXmHFBEivKqERloP6zmA_2((&(*dest).query), (*src).query);
	eq___aBBXmHFBEivKqERloP6zmA_2((&(*dest).anchor), (*src).anchor);
	(*dest).opaque = (*src).opaque;
	(*dest).isIpv6 = (*src).isIpv6;
}
static N_INLINE(void, nimCopyMem)(void* dest, void* source, NI size) {
	void* T1_;
	T1_ = (void*)0;
	T1_ = memcpy(dest, source, ((size_t) (size)));
}
static N_INLINE(void, copyMem__i80o3k0SgEI5gTRCzYdyWAsystem)(void* dest, void* source, NI size) {
	nimCopyMem(dest, source, size);
}
static N_INLINE(void, appendString)(NimStringV2* dest, NimStringV2 src) {
	{
		void* T5_;
		void* T6_;
		if (!(((NI) 0) < src.len)) goto LA3_;
		T5_ = (void*)0;
		T5_ = ((void*) ((&(*(*dest).p).data[(*dest).len])));
		T6_ = (void*)0;
		T6_ = ((void*) ((&(*src.p).data[((NI) 0)])));
		copyMem__i80o3k0SgEI5gTRCzYdyWAsystem(T5_, T6_, ((NI) ((NI)(src.len + ((NI) 1)))));
		(*dest).len += src.len;
	}
	LA3_: ;
}
static N_INLINE(NIM_BOOL, endsWith__IC89a6ZhQ52RmT4pzQl6YbAstrutils)(NimStringV2 s, NIM_CHAR suffix) {
	NIM_BOOL result;
	NIM_BOOL T1_;
	result = (NIM_BOOL)0;
	T1_ = (NIM_BOOL)0;
	T1_ = (((NI) 0) < s.len);
	if (!(T1_)) goto LA2_;
	T1_ = ((NU8)(s.p->data[(s.len-1)]) == (NU8)(suffix));
	LA2_: ;
	result = T1_;
	return result;
}
static N_INLINE(void, nimPrepareStrMutationV2)(NimStringV2* s) {
	{
		NIM_BOOL T3_;
		T3_ = (NIM_BOOL)0;
		T3_ = !(((*s).p == NIM_NIL));
		if (!(T3_)) goto LA4_;
		T3_ = ((NI)((*(*s).p).cap & ((NI) IL64(4611686018427387904))) == ((NI) IL64(4611686018427387904)));
		LA4_: ;
		if (!T3_) goto LA5_;
		nimPrepareStrMutationImpl__C0YoABEefTaYbWLv9aVOzZA(s);
	}
	LA5_: ;
}
static N_INLINE(NimStringV2, X5BX5D___ogYTOKbgqbjPfyC123US1gsystem)(NimStringV2 s, tyObject_HSlice__EE5dzjqoOrHT6HJhIPXAvA x) {
	NimStringV2 result;
	NI a;
	NI L;
	result.len = 0; result.p = NIM_NIL;
	a = x.a;
	L = (NI)((NI)((NI)(s.len - x.b) - a) + ((NI) 1));
	result = mnewString(((NI) (L)));
	{
		NI i;
		NI i_2;
		i = (NI)0;
		i_2 = ((NI) 0);
		{
			while (1) {
				if (!(i_2 < L)) goto LA3;
				i = i_2;
				nimPrepareStrMutationV2((&result));
				result.p->data[i] = s.p->data[(NI)(i + a)];
				i_2 += ((NI) 1);
			} LA3: ;
		}
	}
	return result;
}
static N_INLINE(tyObject_HSlice__EE5dzjqoOrHT6HJhIPXAvA, dotdot___xNR8BVBMWzS9bXXNMikmyLgsystem)(NI a, NI b) {
	tyObject_HSlice__EE5dzjqoOrHT6HJhIPXAvA result;
	nimZeroMem((void*)(&result), sizeof(tyObject_HSlice__EE5dzjqoOrHT6HJhIPXAvA));
	nimZeroMem((void*)(&result), sizeof(tyObject_HSlice__EE5dzjqoOrHT6HJhIPXAvA));
	result.a = a;
	result.b = b;
	return result;
}
N_LIB_PRIVATE N_NIMCALL(NimStringV2, dollar___9aI7qw5xvHD3Zb9b9cJik76iw)(tyObject_Uri__j49bukNPrq747O1GRd4Ng9bQ* u) {
	NimStringV2 result;
	result.len = 0; result.p = NIM_NIL;
	result = TM__VzbRQH9cb1xm1tSKH4PwBSw_18;
	{
		if (!(((NI) 0) < (*u).scheme.len)) goto LA3_;
		prepareAdd((&result), (*u).scheme.len + 0);
appendString((&result), (*u).scheme);
		{
			if (!(*u).opaque) goto LA7_;
			prepareAdd((&result), 1);
appendString((&result), TM__VzbRQH9cb1xm1tSKH4PwBSw_20);
		}
		goto LA5_;
		LA7_: ;
		{
			prepareAdd((&result), 3);
appendString((&result), TM__VzbRQH9cb1xm1tSKH4PwBSw_22);
		}
		LA5_: ;
	}
	LA3_: ;
	{
		if (!(((NI) 0) < (*u).username.len)) goto LA12_;
		prepareAdd((&result), (*u).username.len + 0);
appendString((&result), (*u).username);
		{
			if (!(((NI) 0) < (*u).password.len)) goto LA16_;
			prepareAdd((&result), 1);
appendString((&result), TM__VzbRQH9cb1xm1tSKH4PwBSw_23);
			prepareAdd((&result), (*u).password.len + 0);
appendString((&result), (*u).password);
		}
		LA16_: ;
		prepareAdd((&result), 1);
appendString((&result), TM__VzbRQH9cb1xm1tSKH4PwBSw_25);
	}
	LA12_: ;
	{
		NIM_BOOL T20_;
		T20_ = (NIM_BOOL)0;
		T20_ = endsWith__IC89a6ZhQ52RmT4pzQl6YbAstrutils((*u).hostname, 47);
		if (!T20_) goto LA21_;
		{
			NimStringV2 colontmpD_;
			NimStringV2 colontmpD__2;
			NimStringV2 T27_;
			tyObject_HSlice__EE5dzjqoOrHT6HJhIPXAvA T28_;
			if (!(*u).isIpv6) goto LA25_;
			colontmpD_.len = 0; colontmpD_.p = NIM_NIL;
			colontmpD__2.len = 0; colontmpD__2.p = NIM_NIL;
			T27_.len = 0; T27_.p = NIM_NIL;
			T28_ = dotdot___xNR8BVBMWzS9bXXNMikmyLgsystem(((NI) 0), ((NI) 2));
			colontmpD_ = X5BX5D___ogYTOKbgqbjPfyC123US1gsystem((*u).hostname, T28_);
			T27_ = rawNewString(colontmpD_.len + 2);
appendString((&T27_), TM__VzbRQH9cb1xm1tSKH4PwBSw_27);
appendString((&T27_), colontmpD_);
appendString((&T27_), TM__VzbRQH9cb1xm1tSKH4PwBSw_29);
			colontmpD__2 = T27_;
			prepareAdd((&result), colontmpD__2.len + 0);
appendString((&result), colontmpD__2);
			eqdestroy___dS1BF3Vxjg9aJMmmhVJKSpQ((&colontmpD__2));
			eqdestroy___dS1BF3Vxjg9aJMmmhVJKSpQ((&colontmpD_));
		}
		goto LA23_;
		LA25_: ;
		{
			NimStringV2 colontmpD__3;
			tyObject_HSlice__EE5dzjqoOrHT6HJhIPXAvA T30_;
			colontmpD__3.len = 0; colontmpD__3.p = NIM_NIL;
			T30_ = dotdot___xNR8BVBMWzS9bXXNMikmyLgsystem(((NI) 0), ((NI) 2));
			colontmpD__3 = X5BX5D___ogYTOKbgqbjPfyC123US1gsystem((*u).hostname, T30_);
			prepareAdd((&result), colontmpD__3.len + 0);
appendString((&result), colontmpD__3);
			eqdestroy___dS1BF3Vxjg9aJMmmhVJKSpQ((&colontmpD__3));
		}
		LA23_: ;
	}
	goto LA18_;
	LA21_: ;
	{
		{
			NimStringV2 colontmpD__4;
			NimStringV2 T36_;
			if (!(*u).isIpv6) goto LA34_;
			colontmpD__4.len = 0; colontmpD__4.p = NIM_NIL;
			T36_.len = 0; T36_.p = NIM_NIL;
			T36_ = rawNewString((*u).hostname.len + 2);
appendString((&T36_), TM__VzbRQH9cb1xm1tSKH4PwBSw_30);
appendString((&T36_), (*u).hostname);
appendString((&T36_), TM__VzbRQH9cb1xm1tSKH4PwBSw_31);
			colontmpD__4 = T36_;
			prepareAdd((&result), colontmpD__4.len + 0);
appendString((&result), colontmpD__4);
			eqdestroy___dS1BF3Vxjg9aJMmmhVJKSpQ((&colontmpD__4));
		}
		goto LA32_;
		LA34_: ;
		{
			prepareAdd((&result), (*u).hostname.len + 0);
appendString((&result), (*u).hostname);
		}
		LA32_: ;
	}
	LA18_: ;
	{
		if (!(((NI) 0) < (*u).port.len)) goto LA40_;
		prepareAdd((&result), 1);
appendString((&result), TM__VzbRQH9cb1xm1tSKH4PwBSw_32);
		prepareAdd((&result), (*u).port.len + 0);
appendString((&result), (*u).port);
	}
	LA40_: ;
	{
		if (!(((NI) 0) < (*u).path.len)) goto LA44_;
		{
			NIM_BOOL T48_;
			T48_ = (NIM_BOOL)0;
			T48_ = (((NI) 0) < (*u).hostname.len);
			if (!(T48_)) goto LA49_;
			T48_ = !(((NU8)((*u).path.p->data[((NI) 0)]) == (NU8)(47)));
			LA49_: ;
			if (!T48_) goto LA50_;
			nimAddCharV1((&result), 47);
		}
		LA50_: ;
		prepareAdd((&result), (*u).path.len + 0);
appendString((&result), (*u).path);
	}
	LA44_: ;
	{
		if (!(((NI) 0) < (*u).query.len)) goto LA54_;
		prepareAdd((&result), 1);
appendString((&result), TM__VzbRQH9cb1xm1tSKH4PwBSw_34);
		prepareAdd((&result), (*u).query.len + 0);
appendString((&result), (*u).query);
	}
	LA54_: ;
	{
		if (!(((NI) 0) < (*u).anchor.len)) goto LA58_;
		prepareAdd((&result), 1);
appendString((&result), TM__VzbRQH9cb1xm1tSKH4PwBSw_36);
		prepareAdd((&result), (*u).anchor.len + 0);
appendString((&result), (*u).anchor);
	}
	LA58_: ;
	return result;
}
N_LIB_PRIVATE N_NIMCALL(void, eqdestroy___9cxLel6KY8YRc2RBVO9bQhjw)(tyObject_Uri__j49bukNPrq747O1GRd4Ng9bQ* dest) {
	eqdestroy___dS1BF3Vxjg9aJMmmhVJKSpQ((&(*dest).scheme));
	eqdestroy___dS1BF3Vxjg9aJMmmhVJKSpQ((&(*dest).username));
	eqdestroy___dS1BF3Vxjg9aJMmmhVJKSpQ((&(*dest).password));
	eqdestroy___dS1BF3Vxjg9aJMmmhVJKSpQ((&(*dest).hostname));
	eqdestroy___dS1BF3Vxjg9aJMmmhVJKSpQ((&(*dest).port));
	eqdestroy___dS1BF3Vxjg9aJMmmhVJKSpQ((&(*dest).path));
	eqdestroy___dS1BF3Vxjg9aJMmmhVJKSpQ((&(*dest).query));
	eqdestroy___dS1BF3Vxjg9aJMmmhVJKSpQ((&(*dest).anchor));
}
N_LIB_PRIVATE N_NIMCALL(void, eqsink___OydxUV9ad0I3qVcqasXV7RQ_2)(tyObject_Uri__j49bukNPrq747O1GRd4Ng9bQ* dest, tyObject_Uri__j49bukNPrq747O1GRd4Ng9bQ* src) {
	if ((*dest).scheme.p != (*src).scheme.p) {	eqdestroy___dS1BF3Vxjg9aJMmmhVJKSpQ((&(*dest).scheme));
	}
(*dest).scheme.len = (*src).scheme.len; (*dest).scheme.p = (*src).scheme.p;
	if ((*dest).username.p != (*src).username.p) {	eqdestroy___dS1BF3Vxjg9aJMmmhVJKSpQ((&(*dest).username));
	}
(*dest).username.len = (*src).username.len; (*dest).username.p = (*src).username.p;
	if ((*dest).password.p != (*src).password.p) {	eqdestroy___dS1BF3Vxjg9aJMmmhVJKSpQ((&(*dest).password));
	}
(*dest).password.len = (*src).password.len; (*dest).password.p = (*src).password.p;
	if ((*dest).hostname.p != (*src).hostname.p) {	eqdestroy___dS1BF3Vxjg9aJMmmhVJKSpQ((&(*dest).hostname));
	}
(*dest).hostname.len = (*src).hostname.len; (*dest).hostname.p = (*src).hostname.p;
	if ((*dest).port.p != (*src).port.p) {	eqdestroy___dS1BF3Vxjg9aJMmmhVJKSpQ((&(*dest).port));
	}
(*dest).port.len = (*src).port.len; (*dest).port.p = (*src).port.p;
	if ((*dest).path.p != (*src).path.p) {	eqdestroy___dS1BF3Vxjg9aJMmmhVJKSpQ((&(*dest).path));
	}
(*dest).path.len = (*src).path.len; (*dest).path.p = (*src).path.p;
	if ((*dest).query.p != (*src).query.p) {	eqdestroy___dS1BF3Vxjg9aJMmmhVJKSpQ((&(*dest).query));
	}
(*dest).query.len = (*src).query.len; (*dest).query.p = (*src).query.p;
	if ((*dest).anchor.p != (*src).anchor.p) {	eqdestroy___dS1BF3Vxjg9aJMmmhVJKSpQ((&(*dest).anchor));
	}
(*dest).anchor.len = (*src).anchor.len; (*dest).anchor.p = (*src).anchor.p;
	(*dest).opaque = (*src).opaque;
	(*dest).isIpv6 = (*src).isIpv6;
}
